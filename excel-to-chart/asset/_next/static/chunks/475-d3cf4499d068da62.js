"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[475],{7475:function(e,t,n){n.d(t,{Z:function(){return ChartTemplatePage}});var r=n(5893),l=n(7294),s=n(7027),a=n(4253),i=n(5861),o=n(1057),c=n(8456),d=n(9200),m=n(4386),x=n(657),h=n(3946),u=n(6886),f=n(4254),g=n(8503),p=n(4080),C=n(7440),b=n(5395),j=n(6190),S=n(1556),y=n(5343),Z=n(6235),F=n(4005),E=n(2288),k=n(805),w=n(1120),v=n(6550),z=n(7068),_=n(143),I=n(8540),T=n(532),D=n(5152),R=n.n(D),O=n(1489),P=n(355);let q=R()(()=>Promise.all([n.e(776),n.e(99)]).then(n.bind(n,1719)),{loadableGenerated:{webpack:()=>[1719]},loading:()=>(0,r.jsx)(g.mm,{}),ssr:!1}),B=R()(()=>Promise.all([n.e(776),n.e(889)]).then(n.bind(n,5889)),{loadableGenerated:{webpack:()=>[5889]},loading:()=>(0,r.jsx)(g.mm,{}),ssr:!1});function ChartTemplatePage(e){let{CHART_TYPE:t,ChartComponent:n}=e,{t:a,i18n:i}=(0,T.$G)("common"),o=l.useMemo(()=>e=>(0,r.jsx)(ChartTemplateComponent,{...e,CHART_TYPE:t,ChartComponent:n}),[t,n,i.language]);return(0,r.jsx)(s.Z,{url:t.url,title:a("charts.".concat(t.index,".title")),description:a("charts.".concat(t.index,".description")),imageUrl:t.logoUrl,MainComponent:o})}function ChartTemplateComponent(e){let{CHART_TYPE:t,ChartComponent:n}=e,{t:s}=(0,T.$G)("common"),[D,R]=l.useState(!1),[L,M]=l.useState(!1),[W,A]=l.useState(!1),[G,N]=l.useState(null),[U,Y]=l.useState(!1),[V,$]=l.useState(!1),[H,J]=l.useState(1),[Q,X]=l.useState(!1),[K,ee]=l.useState(1),[et,en]=l.useState(0);(0,O.G)(),l.useEffect(()=>{let handleFullScreenChange=()=>{X(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",handleFullScreenChange),document.addEventListener("webkitfullscreenchange",handleFullScreenChange),document.addEventListener("mozfullscreenchange",handleFullScreenChange),document.addEventListener("MSFullscreenChange",handleFullScreenChange),()=>{document.removeEventListener("fullscreenchange",handleFullScreenChange),document.removeEventListener("webkitfullscreenchange",handleFullScreenChange),document.removeEventListener("mozfullscreenchange",handleFullScreenChange),document.removeEventListener("MSFullscreenChange",handleFullScreenChange)}},[]);let[er,el]=l.useState({file:{helperText:s("index.select_file_button.text"),error:"",errorParams:{}}}),handleFormStateChange=(e,t)=>{el(n=>({...n,[e]:{...n[e],...t}}))},handleEnterFullScreen=async()=>{if(!Q)try{document.documentElement.requestFullscreen?await document.documentElement.requestFullscreen():document.documentElement.mozRequestFullScreen?await document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen?await document.documentElement.webkitRequestFullscreen():document.documentElement.msRequestFullscreen&&await document.documentElement.msRequestFullscreen(),X(!0)}catch(e){console.error("Eneter fullscreen failed:",e)}},handleExitFullScreen=async()=>{if(Q){ee(1);try{document.exitFullscreen?await document.exitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen(),X(!1)}catch(e){console.error("Exit fullscreen failed:",e)}}},es=(0,f.Pr)({chartType:t.index,showSelectChartType:!1,clearChart:()=>Y(!1)}),{sheetNum:ea,setSheetNum:ei,setAllSheets:eo,backgroundColorValue:ec,chartWidth:ed,setChartWidth:em,legendConfig:ex,marginConfig:eh,handleMarginConfigChange:eu,handleLegendConfigPositionChange:ef}=es;l.useEffect(()=>{es.setChartType(t.index),es.handleStyleDefaultOptionsByChartType(t.index)},[]);let{sheetData:eg,isPreLoading:ep,handleSheetRead:eC}=(0,k.U)({onFinish:e=>{console.info("read sheet finished."),eo(e),ei(e.length&&"0"||""),handleOpenDataSelectionOptions()},onError:e=>{handleFormStateChange("file",{error:e}),eo([]),ei("")}}),{excelData:eb,isLoading:ej,handleExcelRead:eS}=(0,z.r)({sheetNumber:ea,onFinish:(e,t)=>{console.info("read file finished."),$(!0)},onError:e=>{handleFormStateChange("file",{error:e})}}),handleOpenDataSelectionOptions=()=>R(!0);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("section",{id:"site-introduction","aria-label":"Introduction of ".concat(p.e.name),children:(0,r.jsxs)(a.Z,{display:"flex",flexDirection:"column",alignItems:"center",gap:1,mt:3,mb:3,children:[(0,r.jsx)(i.Z,{component:"h1",sx:{fontSize:{xs:"1.25rem",sm:"1.35rem"},color:"#0f0f0e",fontWeight:"bold"},children:s("charts.".concat(t.index,".h1"))}),(0,r.jsx)(i.Z,{component:"h2",sx:{fontSize:"1rem",color:"text.secondary",textAlign:"center"},children:s("charts.".concat(t.index,".h2"))})]})}),(0,r.jsx)("section",{id:"select-excel-file-and-create-chart","aria-label":"Select Excel File and Create Chart",children:(0,r.jsxs)(a.Z,{display:"flex",justifyContent:"center",mb:3,sx:{gap:{xs:2,sm:4},flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"center",sm:"stretch"}},children:[(0,r.jsx)(a.Z,{sx:{display:"flex",flexDirection:"column",alignItems:{xs:"center",sm:"flex-start"},gap:1},children:(0,r.jsx)(g.un,{label:s("index.select_file_button.label"),handleFileChange:e=>{let t=e.target.files[0];t&&(N(t),Y(!1),handleFormStateChange("file",{helperText:(0,g.yr)(t.name),error:null}),eC(t).then(()=>{e.target.value=""}))},formState:er})}),(0,r.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"column",alignItems:{xs:"center",sm:"flex-start"},gap:1},children:[(0,r.jsx)(o.Z,{variant:"outlined",onClick:handleOpenDataSelectionOptions,startIcon:ep||ej?(0,r.jsx)(c.Z,{variant:"indeterminate",size:"1.75rem",thickness:5,disableShrink:!0,sx:{color:"#107c41"}}):(0,r.jsx)(w.dn,{chartType:t.index,style:{fontSize:"1.75rem"}}),sx:{width:"13rem",height:"3.5rem",fontSize:"1rem",color:"#141413",borderColor:"#141413","&:hover":{color:"#87867f",borderColor:"#87867f"}},children:s("index.configure_button")}),(0,r.jsx)(i.Z,{variant:"caption",sx:{color:"text.secondary",fontSize:{xs:"0.7rem",sm:"0.75rem"},width:"13rem",textAlign:{xs:"center",sm:"center"}},children:s("index.configure_button_text")}),D&&(0,r.jsx)(q,{open:D,handleClose:()=>R(!1),expanded:W,setExpanded:A,chartType:t.index,chartOptions:es})]}),(0,r.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"column",alignItems:{xs:"center",sm:"flex-start"},gap:1},children:[(0,r.jsx)(o.Z,{variant:"contained",onClick:()=>{if(!ej){if(!G){handleFormStateChange("file",{error:"index.select_file_button.no_upload_error"});return}(0,g.xU)(G,handleFormStateChange)&&!er.file.error&&eS(G).then(()=>{n&&Y(!0)})}},startIcon:ep||ej?(0,r.jsx)(c.Z,{variant:"indeterminate",size:"1.75rem",color:"inherit",thickness:4,disableShrink:!1}):(0,r.jsx)(C.Z,{style:{fontSize:"1.75rem"}}),sx:{width:"13rem",height:"3.5rem",fontSize:"1rem"},children:s("index.create_button")}),(0,r.jsxs)(a.Z,{onClick:()=>M(!0),sx:{display:"flex",width:"13rem",justifyContent:{xs:"center",sm:"center"},alignItems:"center",cursor:"pointer",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)"}},children:[(0,r.jsx)(b.Z,{sx:{color:"#3d3d3a",fontSize:{xs:"1.25rem",sm:"1.35rem"},marginRight:"0.35rem"}}),(0,r.jsx)(i.Z,{sx:{color:"#3d3d3a",fontSize:{xs:"0.7rem",sm:"0.75rem"},fontWeight:600},children:s("index.customize_style_button")})]}),L&&(0,r.jsx)(B,{open:L,handleClose:()=>M(!1),chartType:t.index,chartOptions:es,selectedTab:et,setSelectedTab:en})]})]})}),(0,r.jsxs)("section",{id:"display-created-chart","aria-label":"Display Created Chart",children:[(0,r.jsx)(a.Z,{sx:{display:V&&U&&n?"flex":"none",justifyContent:"flex-end",width:{xs:"100%",sm:"85%",md:"80%"},mr:"auto",ml:"auto",mb:1,gap:1},children:(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(m.Z,{title:"Enable fullscreen",children:(0,r.jsx)(I.Z,{variant:"outlined",size:"small",children:(0,r.jsx)(o.Z,{onClick:handleEnterFullScreen,"aria-label":"enable fullscreen",sx:{backgroundColor:"#44B678",borderColor:"#44B678","&:hover":{backgroundColor:"#3da66c",borderColor:"#3da66c"},color:"white"},children:(0,r.jsx)(y.Z,{})})})}),(0,r.jsx)(g.JV,{backgroundColorValue:ec,chartScale:H,setChartScale:J})]})}),(0,r.jsxs)(a.Z,{justifyContent:"center",alignItems:"center",mb:3,sx:{display:V&&U&&n?"flex":"none",flexDirection:"column",mr:"auto",ml:"auto",bgcolor:_.bI[ec].hex,width:{xs:"100%",sm:"85%",md:"80%"},alignItems:"flex-start",padding:"1rem",borderRadius:"0.25rem",transition:"box-shadow 0.3s ease","&:hover":{boxShadow:"0 0.25rem 0.75rem rgba(45, 130, 89, 0.12)"},overflowX:"auto",WebkitOverflowScrolling:"touch","&::-webkit-scrollbar":{height:{xs:"0.75rem",sm:"0.95rem"},backgroundColor:"#f5f5f5"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#8e8e8e",borderRadius:"0.625rem","&:hover":{backgroundColor:"#747474"}},"&::-webkit-scrollbar-track":{backgroundColor:"#f5f5f5",borderRadius:"0.625rem"}},children:[Q&&(0,r.jsx)(x.Z,{fullScreen:!0,open:Q,onClose:()=>X(!1),PaperProps:{style:{backgroundColor:"#F1E6D0"}},children:(0,r.jsxs)("div",{style:{position:"relative",width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,r.jsxs)(a.Z,{sx:{position:"absolute",top:"1rem",right:"1rem",display:"flex",gap:2,zIndex:1},children:[(0,r.jsx)(m.Z,{title:"Zoom out",children:(0,r.jsx)(h.Z,{onClick:()=>{ee(e=>Math.max(e-.25,.25))},disabled:K<=.5,"aria-label":"zoom out",children:(0,r.jsx)(E.Z,{sx:{fontSize:{xs:"1.5rem",sm:"2rem"}}})})}),(0,r.jsx)(m.Z,{title:"Zoom in",children:(0,r.jsx)(h.Z,{onClick:()=>{ee(e=>Math.min(e+.25,3))},disabled:K>=3,"aria-label":"zoom in",children:(0,r.jsx)(F.Z,{sx:{fontSize:{xs:"1.5rem",sm:"2rem"}}})})}),(0,r.jsx)(m.Z,{title:"Exit fullscreen",children:(0,r.jsx)(h.Z,{onClick:handleExitFullScreen,"aria-label":"exit fullscreen",children:(0,r.jsx)(Z.Z,{sx:{fontSize:{xs:"1.5rem",sm:"2rem"}}})})})]}),(0,r.jsx)("div",{id:"chart-container-fullscreen",style:{transform:"scale(".concat(K,")"),transition:"transform 0.3s ease"},children:eb.length>0&&U&&n&&(0,r.jsx)(n,{dataset:eb,chartOptions:es})})]})}),(0,r.jsx)("div",{id:"chart-container",children:eb.length>0&&U&&n&&(0,r.jsx)(n,{dataset:eb,chartOptions:es})})]})]}),(0,r.jsx)("section",{id:"exceltochart-quick-chart-fixes","aria-label":"ExcelToChart Quick Chart Fixes",children:(0,r.jsxs)(a.Z,{display:"flex",flexDirection:"column",alignItems:"center",gap:1,mb:3,sx:{bgcolor:"#EBDBBC",borderRadius:"0.25rem",padding:"1rem",mr:"auto",ml:"auto",width:{xs:"100%",sm:"85%",md:"80%"}},children:[(0,r.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)(S.Z,{sx:{fontSize:{xs:"1.75rem",sm:"1.95rem"},color:"#141413",opacity:.9}}),(0,r.jsx)(i.Z,{component:"h3",sx:{color:"#0f0f0e",fontWeight:500,fontSize:{xs:"1.15rem",sm:"1.25rem"},textAlign:"center"},children:s("index.chart_quick_fixes.title")})]}),(0,r.jsx)(a.Z,{display:"flex",justifyContent:"center",sx:{width:"100%",alignItems:{xs:"center",sm:"stretch"},py:2,px:{xs:2,sm:3}},children:(0,r.jsx)(P.Z,{chartWidth:ed,setChartWidth:em,legendConfig:ex,marginConfig:eh,handleMarginConfigChange:eu,handleLegendConfigPositionChange:ef})})]})}),(0,r.jsx)("section",{id:"create-more-chart-types","aria-label":"More Chart Types You Can Create",children:(0,r.jsxs)(a.Z,{display:"flex",flexDirection:"column",alignItems:"center",gap:1,mb:3,sx:{bgcolor:"#EBDBBC",borderRadius:"0.25rem",padding:"1rem",mr:"auto",ml:"auto",width:{xs:"100%",sm:"85%",md:"80%"}},children:[(0,r.jsxs)(a.Z,{sx:{display:"flex",alignItems:"stretch",gap:1},children:[(0,r.jsx)(j.Z,{sx:{fontSize:{xs:"1.75rem",sm:"1.95rem"},color:"#141413",opacity:.9}}),(0,r.jsx)(i.Z,{component:"h3",sx:{color:"#0f0f0e",fontWeight:500,fontSize:{xs:"1.15rem",sm:"1.25rem"},textAlign:"center",wordBreak:"break-all"},children:s("index.more_charts_title")})]}),(0,r.jsx)(a.Z,{display:"flex",justifyContent:"center",sx:{alignItems:{xs:"center",sm:"stretch"}},children:(0,r.jsx)(u.ZP,{container:!0,spacing:3,sx:{py:2,px:{xs:2,sm:3}},children:v.y.filter(e=>e.index!==t.index).map((e,t)=>(0,r.jsx)(u.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(g.No,{chart:e})},t))})})]})})]})}}}]);